var Pinger={startTime:"",listener:{onSuccess:{},onError:{}},_start:function(){this.startTime=(new Date).getTime()},_getTimeSinceStart:function(){return Number((new Date).getTime())-Number(this.startTime)},addListener:function(a){Pinger.listener=a},ping:function(a){this._start();$.ajax({url:a,cache:false,timeout:5e3,success:function(a){Pinger.listener.onSuccess({responseTime:Pinger._getTimeSinceStart(),processingTime:a.processingTime,errormessage:"noError"})},error:function(a,b){Pinger.listener.onError({jqXHR:a,errormessage:b})}})}};var PingerViewModel={buttonText:ko.observable("Ping Me!"),responseTimeText:ko.observable(""),processingTimeText:ko.observable(""),networkLatencyText:ko.observable(""),isFailed:ko.observable(false),errorText:ko.observable(""),isBusy:ko.observable(false),pinger:Pinger,setPinger:function(a){PingerViewModel.pinger=a},accessResource:function(){PingerViewModel.isBusy(true);PingerViewModel.pinger.addListener(PingerViewModel);PingerViewModel.pinger.ping("ping.do")},onSuccess:function(a){PingerViewModel.isFailed(false);var b=a.responseTime-a.processingTime;var c=b/a.responseTime*100;var d=a.processingTime/a.responseTime*100;PingerViewModel.responseTimeText("response time: "+a.responseTime+" ms");PingerViewModel.processingTimeText("processing Time: "+a.processingTime+" ms ["+d.toFixed(4)+"%]");PingerViewModel.networkLatencyText("network delay: "+b+" ms ["+c.toFixed(4)+"%]");PingerViewModel.buttonText("Ping Again!");PingerViewModel.isBusy(false)},onError:function(a,b){PingerViewModel.isFailed(true);if(a.errormessage=="timeout"){PingerViewModel.errorText("Request has timed out. Ping Again!")}if(a.errormessage=="unavailable"){PingerViewModel.errorText("Request is unavailable. Ping Again!")}PingerViewModel.isBusy(false)}};$(document).ready(function(){ko.applyBindings(PingerViewModel)})
